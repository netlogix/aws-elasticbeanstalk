privilegeTargets:

  'TYPO3\Flow\Security\Authorization\Privilege\Method\MethodPrivilege':

    'Netlogix.Aws.ElasticBeanstalk:WorkerEnvironment':
      matcher: 'method(Netlogix\Aws\ElasticBeanstalk\Controller\WorkerController->(?!initialize).*Action())'

roles:

  'TYPO3.Flow:Everybody':
    privileges:
      -
        # Grant everyone as the TYPO3.Flow.security.firewall settings should protect it from the outside
        # Only needed to counter rule in TYPO3.Neos:AllControllerActions
        # FIXME alternatively authenticate requests from ElasticBeanstalk sqsd, somehow...
        privilegeTarget: 'Netlogix.Aws.ElasticBeanstalk:WorkerEnvironment'
        permission: GRANT
